# OS

## 运行

- 加载运行
- 内核用户态

## 进程管理

### 进程 线程 协程

进程：虚拟地址空间（栈、堆、静态、二进制）、文件描述符、信号量。

当进行进程切换时，由于每个进程都有自己的虚拟地址空间，TLB中缓存的映射关系可能不再适用于新的进程。因此，为了避免潜在的歧义，系统通常会在进程切换时清空（flush）整个TLB，以确保新进程的地址转换能够正确进行。


线程：pc、sp、bp、寄存器 + 栈 。共享堆空间，需要考虑资源竞争问题。

线程调度和进程调度都属于操作系统代码，因此需要陷入内核。


协程：pc、sp、bp。
协程调度是用户行为，比线程更加轻量化。

### 同步

操作系统线程同步机制: 互斥锁、读写锁、条件变量、自旋锁、信号量

语言线程同步机制：不同语言提供的同步方法不一样，但是语言层面线程同步基本都是通过操作系统同步机制实现，屏蔽了不同操作系统的差异。

语言协程同步机制: 互斥锁、自旋锁、读写锁、可重入锁、队列等


### 调度

操作系统进程/线程调度：python multithread是通过操作系统调度的。 先来先到调度、时间片调度、多级队列调度。

语言层面协程调度：python协程基于事件循环进行调度、golang协程基于GMP进行调度。

## 内存管理
虚拟内存 alloc free 垃圾回收
物理内存 页表 缺页中断 换入换出算法

进程虚拟内存组织形式

fork的内容 cow


## I/O管理

I/O模型 epoll redis、netty、nginx模型 sendfile
