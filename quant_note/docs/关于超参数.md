# 超参数
在模型中，一定存在着超参数设置。比如，roi stoploss等都是需要依靠大量经验或者回测来设置。
如何通过算法，快速找到较优的参数设置，是赢取超额收益的关键。

## FreqTrade HyperOpt
指令如下：
`freqtrade hyperopt --config config.json --hyperopt-loss ShortTradeDurHyperOptLoss --strategy <strategyname> --timerange 20230101-20230201 -e 500 --spaces roi stoploss trailing`

### 超参数类型
有四种参数类型，每种类型适合不同的目的。
- IntParameter- 定义具有搜索空间上限和下限的积分参数。
- DecimalParameter- 定义具有有限小数位数（默认 3）的浮点参数。RealParameter在大多数情况下应该是首选。
- RealParameter- 定义具有上限和下限且无精度限制的浮点参数。很少使用，因为它创造了一个具有近乎无限多种可能性的空间。
- CategoricalParameter- 定义具有预定数量选择的参数。
- BooleanParameter- 简写CategoricalParameter([True, False])- 非常适合“启用”参数。

### 参数优化原理
Hyperopt首先将数据加载到内存中，然后调用populate_indicators()生成所有指标。

Hyperopt将生成不同的进程（处理器数量，或-j <n>），并一遍又一遍地运行回溯测试，更改属于--spaces定义一部分的参数。

对于每组新参数，freqtrade将首先运行populate_entry_trend()，populate_exit_trend()然后运行常规回测过程来模拟交易。

回溯测试后，结果被传递到损失函数中，该函数将评估此结果是否比之前的结果更好或更差。

根据损失函数结果，hyperopt 将确定下一轮回测中要尝试的下一组参数。


### 优化空间
- all: 优化一切
- buy：只需寻找新的购买策略
- sell：只是寻找新的买出策略
- roi：只需优化您策略的最小利润表
- stoploss：寻找最佳止损值
- trailing：搜索最佳追踪止损值
- trades：搜索最佳最大未平仓交易值
- protection：搜索最佳保护参数（阅读保护部分以了解如何正确定义这些参数）
- default：all除了trailing和protection


### 损失函数
Each hyperparameter tuning requires a target.
This is usually defined as a loss function.
Our goal is decrease loss for more desirable results.
内置损失函数：

- ShortTradeDurHyperOptLoss- （默认传统 Freqtrade 超优化损失函数） - 主要用于短交易持续时间和避免损失。
- OnlyProfitHyperOptLoss- 仅考虑利润金额。
- SharpeHyperOptLoss- 优化根据相对于标准差的交易回报计算的夏普比率。
- SharpeHyperOptLossDaily- 优化根据每日交易回报相对于标准差计算的夏普比率。
- SortinoHyperOptLoss- 优化根据相对于下行标准差的交易回报计算的索蒂诺比率。
- SortinoHyperOptLossDaily- 优化根据每日交易回报相对于下行标准差计算的索蒂诺比率。
- MaxDrawDownHyperOptLoss- 优化最大绝对回撤。
- MaxDrawDownRelativeHyperOptLoss- 优化最大绝对回撤，同时调整最大相对回撤。
- CalmarHyperOptLoss- 优化根据相对于最大回撤的交易回报计算的卡尔玛比率。
- ProfitDrawDownHyperOptLoss- 通过最大利润和最小回撤目标进行优化。DRAWDOWN_MULThyperoptloss 文件中的变量可以根据回撤目的调整为更严格或更灵活。

支持自定义损失函数